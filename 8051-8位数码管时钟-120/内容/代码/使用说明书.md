# LED数码管电子钟使用说明书

## 一、功能概述

本电子钟基于STC系列单片机（AT89C51）和DS1302实时时钟芯片设计，具有以下功能：

| 功能 | 描述 |
|------|------|
| 时间显示 | 8位数码管显示 "时时-分分-秒秒" 格式 |
| 时间设置 | 通过K1-K4按键设置当前时间 |
| 闹钟功能 | 通过K5-K6按键设置闹钟时间 |
| 闹钟提醒 | 蜂鸣器响铃 + 继电器动作 |
| 工作指示 | LED每秒闪烁表示程序运行 |

---

## 二、硬件连接

### 引脚配置表

| 引脚 | 连接 | 功能说明 |
|------|------|----------|
| P0.0-P0.7 | 数码管段码 | a-g段 + dp小数点 |
| P2.0-P2.7 | 数码管位选 | 8位数码管选择 |
| P1.2 | DS1302 SCLK | 时钟芯片时钟线 |
| P1.3 | DS1302 IO | 时钟芯片数据线 |
| P1.4 | DS1302 RST | 时钟芯片复位线 |
| P1.7 | LED工作指示灯 | 程序运行指示 |
| P3.0 | K1按键 | 进入时间设置模式 |
| P3.1 | K2按键 | 设置小时 |
| P3.2 | K3按键 | 设置分钟 |
| P3.3 | K4按键 | 确认设置 |
| P3.4 | 蜂鸣器 | 闹钟响铃 |
| P3.5 | K5按键 | 设置闹钟小时 |
| P3.6 | K6按键 | 设置闹钟分钟 |
| P3.7 | 继电器 | 闹钟联动输出 |

### 数码管类型
- **共阳极**数码管
- **高电平**位选

---

## 三、按键操作说明

### 3.1 设置当前时间

| 步骤 | 操作 | 显示效果 |
|------|------|----------|
| 1 | 按K1 | 进入设置小时模式，小时位闪烁 |
| 2 | 按K2 | 小时+1（0-23循环） |
| 3 | 按K1 | 切换到设置分钟模式，分钟位闪烁 |
| 4 | 按K3 | 分钟+1（0-59循环） |
| 5 | 按K4 | 确认设置，返回正常显示，秒归零 |

> **提示**：在设置模式下再按K1可以循环切换设置项或退出。

### 3.2 设置闹钟时间

| 步骤 | 操作 | 显示效果 |
|------|------|----------|
| 1 | 按K5 | 进入设置闹钟小时模式，显示闹钟时间 |
| 2 | 按K5 | 闹钟小时+1（0-23循环） |
| 3 | 按K6 | 切换到设置闹钟分钟模式 |
| 4 | 按K6 | 闹钟分钟+1（0-59循环） |
| 5 | 按K4 | 确认设置并开启闹钟，返回正常显示 |

### 3.3 停止闹钟

当闹钟响起时（蜂鸣器响+继电器动作）：
- **按任意按键**即可停止闹钟

---

## 四、工作模式说明

| 模式值 | 模式名称 | 说明 |
|--------|----------|------|
| 0 | 正常显示 | 显示当前时间，DS1302自动计时 |
| 1 | 设置小时 | 小时位闪烁，K2调整 |
| 2 | 设置分钟 | 分钟位闪烁，K3调整 |
| 3 | 设置闹钟小时 | 显示闹钟时间，小时位闪烁，K5调整 |
| 4 | 设置闹钟分钟 | 显示闹钟时间，分钟位闪烁，K6调整 |

---

## 五、显示格式

```
位置:  0  1  2  3  4  5  6  7
显示:  H  H  -  M  M  -  S  S
       时 时     分 分     秒 秒
```

- 位置2和5显示分隔符"-"
- 设置模式下对应位置会闪烁（500ms亮/500ms灭）

---

## 六、闹钟工作原理

1. **触发条件**：当前时间的 小时:分钟:秒 = 闹钟小时:闹钟分钟:00
2. **响铃模式**：蜂鸣器和继电器以500ms间隔交替动作（250ms开，250ms关）
3. **停止方式**：按任意按键

---

## 七、编译与下载

### 7.1 编译环境
- Keil uVision 4/5
- 芯片型号：AT89C51 或 STC89C52

### 7.2 编译步骤
1. 打开 `动态数码管.uvproj` 工程文件
2. 点击 Build → Rebuild All
3. 生成HEX文件位于 Objects 目录

### 7.3 仿真测试
1. 打开Proteus仿真软件
2. 加载对应的仿真电路图
3. 双击单片机，设置HEX文件路径
4. 点击运行按钮开始仿真

---

## 八、常见问题

| 问题 | 可能原因 | 解决方法 |
|------|----------|----------|
| 数码管不亮 | 段码/位选极性错误 | 检查共阳/共阴类型 |
| 数码管闪烁 | 扫描频率太低 | 检查定时器设置 |
| 时间不走 | DS1302连接错误 | 检查RST/SCLK/IO引脚 |
| 按键无反应 | 按键接线错误 | 检查按键引脚连接 |
| 闹钟不响 | 闹钟未开启 | 按K4确认开启闹钟 |

---

## 九、初始状态

程序启动后：
- 时间初始化为 **00:00:00**
- 闹钟时间默认为 **00:01**（1分钟后响）
- 闹钟默认 **开启**
- 工作指示灯开始闪烁
